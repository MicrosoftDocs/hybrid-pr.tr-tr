---
title: Azure ve Azure Stack hub kullanan bir betfall algılama kalıbı
description: Retail Store trafiğini çözümlemek için bir AI tabanlı bir ıtfall algılama çözümü uygulamak üzere Azure ve Azure Stack hub 'ı nasıl kullanacağınızı öğrenin.
author: BryanLa
ms.topic: article
ms.date: 10/31/2019
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 10/31/2019
ms.openlocfilehash: 0bf07bb38537f530a0adb3569c43d53af13b8d56
ms.sourcegitcommit: bb3e40b210f86173568a47ba18c3cc50d4a40607
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 06/17/2020
ms.locfileid: "84912002"
---
# <a name="footfall-detection-pattern"></a><span data-ttu-id="0d8ad-103">Betfall algılama kalıbı</span><span class="sxs-lookup"><span data-stu-id="0d8ad-103">Footfall detection pattern</span></span>

<span data-ttu-id="0d8ad-104">Bu düzende, perakende mağazalarındaki ziyaretçi trafiğini çözümlemek için bir AI tabanlı bir kantfall algılama çözümü uygulamaya yönelik bir genel bakış sunulmaktadır.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-104">This pattern provides an overview for implementing an AI-based footfall detection solution for analyzing visitor traffic in retail stores.</span></span> <span data-ttu-id="0d8ad-105">Çözüm, Azure, Azure Stack hub ve Özel Görüntü İşleme AI Dev Kit kullanarak gerçek dünya eylemlerinden Öngörüler oluşturur.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-105">The solution generates insights from real world actions, using Azure, Azure Stack Hub, and the Custom Vision AI Dev Kit.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="0d8ad-106">Bağlam ve sorun</span><span class="sxs-lookup"><span data-stu-id="0d8ad-106">Context and problem</span></span>

<span data-ttu-id="0d8ad-107">Contoso mağazalarının, müşterilerin güncel ürünlerini mağaza düzenine göre nasıl aldığını hakkında öngörüler elde etmek ister.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-107">Contoso Stores would like to gain insights on how customers are receiving their current products in relation to store layout.</span></span> <span data-ttu-id="0d8ad-108">Her bölüme personeli yerleştiremiyor ve bir analistlerin bir yöneticisinin tüm mağazanın kamera görüntülerini incelemesi için verimsiz bir takım.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-108">They're unable to place staff in every section and it's inefficient to have a team of analysts review an entire store's camera footage.</span></span> <span data-ttu-id="0d8ad-109">Bunlara ek olarak, mağazaların hiçbirinde tüm kameralardan analiz için buluta video akışı yapmak için yeterli bant genişliği yoktur.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-109">In addition, none of their stores have enough bandwidth to stream video from all their cameras to the cloud for analysis.</span></span>

<span data-ttu-id="0d8ad-110">Contoso, müşterilerinin demograflarını, kısa bir süre içinde, ekran ve ürünleri depolamak için müşterilerin demograflarını, bağlılık ve yeniden eylemlerini belirlemenin kolay bir yolunu bulmak istiyor.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-110">Contoso would like to find an unobtrusive, privacy-friendly way to determine their customers' demographics, loyalty, and reactions to store displays and products.</span></span>

## <a name="solution"></a><span data-ttu-id="0d8ad-111">Çözüm</span><span class="sxs-lookup"><span data-stu-id="0d8ad-111">Solution</span></span>

<span data-ttu-id="0d8ad-112">Bu Retail Analytics deseninin kenar altına almak için katmanlı bir yaklaşım kullanılır.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-112">This retail analytics pattern uses a tiered approach to inferencing at the edge.</span></span> <span data-ttu-id="0d8ad-113">Özel Görüntü İşleme AI geliştirme setini kullanarak, Azure bilişsel hizmetler 'i çalıştıran özel bir Azure Stack hub 'ına analiz edilmek üzere yalnızca insan yüzlerine sahip görüntüler gönderilir.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-113">By using the Custom Vision AI Dev Kit, only images with human faces are sent for analysis to a private Azure Stack Hub that runs Azure Cognitive Services.</span></span> <span data-ttu-id="0d8ad-114">Anonimleştirilmiş, toplanan veriler Power BI tüm depolarda ve görselleştirmede toplama için Azure 'a gönderilir.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-114">Anonymized, aggregated data is sent to Azure for aggregation across all stores and visualization in Power BI.</span></span> <span data-ttu-id="0d8ad-115">Edge ve genel bulutu birleştirmek, contoso 'nun modern AI teknolojisinden yararlanarak şirket ilkeleriyle uyumlu olduğundan ve müşterilerinin gizliliğini de daha da yararlanmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-115">Combining the edge and public cloud lets Contoso take advantage of modern AI technology while also remaining in compliance with their corporate policies and respecting their customers' privacy.</span></span>

<span data-ttu-id="0d8ad-116">[![Betfall algılama deseninin çözümü](media/pattern-retail-footfall-detection/solution-architecture.png)](media/pattern-retail-footfall-detection/solution-architecture.png)</span><span class="sxs-lookup"><span data-stu-id="0d8ad-116">[![Footfall detection pattern solution](media/pattern-retail-footfall-detection/solution-architecture.png)](media/pattern-retail-footfall-detection/solution-architecture.png)</span></span>

<span data-ttu-id="0d8ad-117">Çözümün nasıl çalıştığına ilişkin bir özet aşağıda verilmiştir:</span><span class="sxs-lookup"><span data-stu-id="0d8ad-117">Here's a summary of how the solution works:</span></span>

1. <span data-ttu-id="0d8ad-118">Özel Görüntü İşleme AI Dev Kit, IoT Edge çalışma zamanını ve bir ML modelini yükleyerek IoT Hub bir yapılandırma alır.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-118">The Custom Vision AI Dev Kit gets a configuration from IoT Hub, which installs the IoT Edge Runtime and an ML model.</span></span>
2. <span data-ttu-id="0d8ad-119">Model bir kişi görürse, bir resim alır ve Azure Stack hub BLOB depolama alanına yükler.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-119">If the model sees a person, it takes a picture and uploads it to Azure Stack Hub blob storage.</span></span>
3. <span data-ttu-id="0d8ad-120">Blob hizmeti Azure Stack hub 'da bir Azure Işlevi tetikler.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-120">The blob service triggers an Azure Function on Azure Stack Hub.</span></span>
4. <span data-ttu-id="0d8ad-121">Azure Işlevi, görüntüden demografik ve duygu verileri almak için Yüz Tanıma API'si bir kapsayıcı çağırır.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-121">The Azure Function calls a container with the Face API to get demographic and emotion data from the image.</span></span>
5. <span data-ttu-id="0d8ad-122">Veriler anonimleştirilmiştir ve bir Azure Event Hubs kümesine gönderilir.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-122">The data is anonymized and sent to an Azure Event Hubs cluster.</span></span>
6. <span data-ttu-id="0d8ad-123">Event Hubs kümesi, verileri Stream Analytics 'e iter.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-123">The Event Hubs cluster pushes the data to Stream Analytics.</span></span>
7. <span data-ttu-id="0d8ad-124">Stream Analytics verileri toplar ve Power BI gönderir.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-124">Stream Analytics aggregates the data and pushes it to Power BI.</span></span>

## <a name="components"></a><span data-ttu-id="0d8ad-125">Bileşenler</span><span class="sxs-lookup"><span data-stu-id="0d8ad-125">Components</span></span>

<span data-ttu-id="0d8ad-126">Bu çözüm aşağıdaki bileşenleri kullanır:</span><span class="sxs-lookup"><span data-stu-id="0d8ad-126">This solution uses the following components:</span></span>

| <span data-ttu-id="0d8ad-127">Katman</span><span class="sxs-lookup"><span data-stu-id="0d8ad-127">Layer</span></span> | <span data-ttu-id="0d8ad-128">Bileşen</span><span class="sxs-lookup"><span data-stu-id="0d8ad-128">Component</span></span> | <span data-ttu-id="0d8ad-129">Description</span><span class="sxs-lookup"><span data-stu-id="0d8ad-129">Description</span></span> |
|----------|-----------|-------------|
| <span data-ttu-id="0d8ad-130">Mağaza içi donanım</span><span class="sxs-lookup"><span data-stu-id="0d8ad-130">In-store hardware</span></span> | [<span data-ttu-id="0d8ad-131">Özel Görüntü İşleme AI geliştirme seti</span><span class="sxs-lookup"><span data-stu-id="0d8ad-131">Custom Vision AI Dev Kit</span></span>](https://azure.github.io/Vision-AI-DevKit-Pages/) | <span data-ttu-id="0d8ad-132">Yalnızca analiz için kişilerin görüntülerini yakalayan yerel bir ML modeli kullanarak mağaza içi filtreleme sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-132">Provides in-store filtering using a local ML model that only captures images of people for analysis.</span></span> <span data-ttu-id="0d8ad-133">IoT Hub aracılığıyla güvenli bir şekilde sağlanmış ve güncelleştirilmiş.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-133">Securely provisioned and updated through IoT Hub.</span></span><br><br>|
| <span data-ttu-id="0d8ad-134">Azure</span><span class="sxs-lookup"><span data-stu-id="0d8ad-134">Azure</span></span> | [<span data-ttu-id="0d8ad-135">Azure Event Hubs</span><span class="sxs-lookup"><span data-stu-id="0d8ad-135">Azure Event Hubs</span></span>](/azure/event-hubs/) | <span data-ttu-id="0d8ad-136">Azure Event Hubs, Azure Stream Analytics ile düzenli olarak tümleşen anonim verileri almak için ölçeklenebilir bir platform sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-136">Azure Event Hubs provides a scalable platform for ingesting anonymized data that integrates neatly with Azure Stream Analytics.</span></span> |
|  | [<span data-ttu-id="0d8ad-137">Azure Akış Analizi</span><span class="sxs-lookup"><span data-stu-id="0d8ad-137">Azure Stream Analytics</span></span>](/azure/stream-analytics/) | <span data-ttu-id="0d8ad-138">Azure Stream Analytics bir iş, anonimleştirilmiş verileri toplar ve görselleştirme için 15 saniyelik Windows ile gruplandırır.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-138">An Azure Stream Analytics job aggregates the anonymized data and groups it into 15-second windows for visualization.</span></span> |
|  | [<span data-ttu-id="0d8ad-139">Microsoft Power BI</span><span class="sxs-lookup"><span data-stu-id="0d8ad-139">Microsoft Power BI</span></span>](https://powerbi.microsoft.com/) | <span data-ttu-id="0d8ad-140">Power BI, çıktıyı Azure Stream Analytics görüntülemek için kullanımı kolay bir pano arabirimi sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-140">Power BI provides an easy-to-use dashboard interface for viewing the output from Azure Stream Analytics.</span></span> |
| <span data-ttu-id="0d8ad-141">Azure Stack hub 'ı</span><span class="sxs-lookup"><span data-stu-id="0d8ad-141">Azure Stack Hub</span></span> | [<span data-ttu-id="0d8ad-142">App Service</span><span class="sxs-lookup"><span data-stu-id="0d8ad-142">App Service</span></span>](/azure-stack/operator/azure-stack-app-service-overview.md) | <span data-ttu-id="0d8ad-143">App Service kaynak sağlayıcısı (RP), Web Apps/API ve Işlevlerine yönelik barındırma ve yönetim özellikleri de dahil olmak üzere Edge bileşenleri için bir temel sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-143">The App Service resource provider (RP) provides a base for edge components, including hosting and management features for web apps/APIs and Functions.</span></span> |
| | <span data-ttu-id="0d8ad-144">Azure Kubernetes hizmeti [(aks) altyapısı](https://github.com/Azure/aks-engine) kümesi</span><span class="sxs-lookup"><span data-stu-id="0d8ad-144">Azure Kubernetes Service [(AKS) Engine](https://github.com/Azure/aks-engine) cluster</span></span> | <span data-ttu-id="0d8ad-145">Azure Stack hub 'ına dağıtılan AKS-Engine kümesi ile AKS RP, Yüz Tanıma API'si kapsayıcısını çalıştırmak için ölçeklenebilir ve dayanıklı bir altyapı sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-145">The AKS RP with AKS-Engine cluster deployed into Azure Stack Hub provides a scalable, resilient engine to run the Face API container.</span></span> |
| | <span data-ttu-id="0d8ad-146">Azure bilişsel Hizmetler [Yüz Tanıma API'si kapsayıcıları](/azure/cognitive-services/face/face-how-to-install-containers)</span><span class="sxs-lookup"><span data-stu-id="0d8ad-146">Azure Cognitive Services [Face API containers](/azure/cognitive-services/face/face-how-to-install-containers)</span></span>| <span data-ttu-id="0d8ad-147">Yüz Tanıma API'si kapsayıcılarıyla Azure bilişsel hizmetler RP, contoso 'nun özel ağında demografik, duygu ve benzersiz ziyaretçi algılaması sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-147">The Azure Cognitive Services RP with Face API containers provides demographic, emotion, and unique visitor detection on Contoso's private network.</span></span> |
| | <span data-ttu-id="0d8ad-148">Blob Depolama</span><span class="sxs-lookup"><span data-stu-id="0d8ad-148">Blob Storage</span></span> | <span data-ttu-id="0d8ad-149">AI Dev Kit 'ten yakalanan görüntüler Azure Stack hub 'ın BLOB depolama alanına yüklenir.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-149">Images captured from the AI Dev Kit are uploaded to Azure Stack Hub's blob storage.</span></span> |
| | <span data-ttu-id="0d8ad-150">Azure İşlevleri</span><span class="sxs-lookup"><span data-stu-id="0d8ad-150">Azure Functions</span></span> | <span data-ttu-id="0d8ad-151">Azure Stack Hub üzerinde çalışan bir Azure Işlevi, blob depolamadan giriş alır ve Yüz Tanıma API'si etkileşimleri yönetir.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-151">An Azure Function running on Azure Stack Hub receives input from blob storage and manages the interactions with the Face API.</span></span> <span data-ttu-id="0d8ad-152">Anonim verileri Azure 'da bulunan bir Event Hubs kümesine yayar.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-152">It emits anonymized data to an Event Hubs cluster located in Azure.</span></span><br><br>|

## <a name="issues-and-considerations"></a><span data-ttu-id="0d8ad-153">Sorunlar ve dikkat edilmesi gerekenler</span><span class="sxs-lookup"><span data-stu-id="0d8ad-153">Issues and considerations</span></span>

<span data-ttu-id="0d8ad-154">Bu çözümü nasıl uygulayacağınıza karar verirken aşağıdaki noktaları göz önünde bulundurun:</span><span class="sxs-lookup"><span data-stu-id="0d8ad-154">Consider the following points when deciding how to implement this solution:</span></span>

### <a name="scalability"></a><span data-ttu-id="0d8ad-155">Ölçeklenebilirlik</span><span class="sxs-lookup"><span data-stu-id="0d8ad-155">Scalability</span></span>

<span data-ttu-id="0d8ad-156">Bu çözümün birden çok kamera ve konumda ölçeklendirilmesini sağlamak için tüm bileşenlerin daha fazla yükü işleyebilmesini sağlamak gerekir.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-156">To enable this solution to scale across multiple cameras and locations, you'll need to make sure that all of the components can handle the increased load.</span></span> <span data-ttu-id="0d8ad-157">Şunlar gibi eylemler gerçekleştirmeniz gerekebilir:</span><span class="sxs-lookup"><span data-stu-id="0d8ad-157">You may need to take actions like:</span></span>

- <span data-ttu-id="0d8ad-158">Stream Analytics akış birimi sayısını artırın.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-158">Increase the number of Stream Analytics streaming units.</span></span>
- <span data-ttu-id="0d8ad-159">Yüz Tanıma API'si dağıtımını ölçeklendirin.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-159">Scale out the Face API deployment.</span></span>
- <span data-ttu-id="0d8ad-160">Event Hubs kümesi verimini artırın.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-160">Increase the Event Hubs cluster throughput.</span></span>
- <span data-ttu-id="0d8ad-161">Olağanüstü durumlarda Azure Işlevlerinden bir sanal makineye geçiş yapmanız gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-161">For extreme cases, migrate from Azure Functions to a virtual machine may be necessary.</span></span>

### <a name="availability"></a><span data-ttu-id="0d8ad-162">Kullanılabilirlik</span><span class="sxs-lookup"><span data-stu-id="0d8ad-162">Availability</span></span>

<span data-ttu-id="0d8ad-163">Bu çözüm katmanlı olduğundan, ağ veya güç arızalarının nasıl ele alınacağını düşünmek önemlidir.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-163">Since this solution is tiered, it's important to think about how to deal with networking or power failures.</span></span> <span data-ttu-id="0d8ad-164">İş ihtiyaçlarına bağlı olarak, görüntüleri yerel olarak önbelleğe almak için bir mekanizma uygulamak, sonra bağlantı döndürüldüğünde Azure Stack hub 'a iletmek isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-164">Depending on business needs, you might want to implement a mechanism to cache images locally, then forward to Azure Stack Hub when connectivity returns.</span></span> <span data-ttu-id="0d8ad-165">Konum yeterince büyükse, bu konuma Yüz Tanıma API'si kapsayıcı ile Data Box Edge dağıtımı daha iyi bir seçenek olabilir.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-165">If the location is large enough, deploying a Data Box Edge with the Face API container to that location might be a better option.</span></span>

### <a name="manageability"></a><span data-ttu-id="0d8ad-166">Yönetilebilirlik</span><span class="sxs-lookup"><span data-stu-id="0d8ad-166">Manageability</span></span>

<span data-ttu-id="0d8ad-167">Bu çözüm, çok sayıda cihaza ve konuma yayılabilir ve bu da bir süre sonra olabilir.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-167">This solution can span many devices and locations, which could get unwieldy.</span></span> <span data-ttu-id="0d8ad-168">[Azure 'un IoT Hizmetleri](/azure/iot-fundamentals/) , yeni konumları ve cihazları otomatik olarak çevrimiçi hale getirmek ve güncel tutmak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-168">[Azure's IoT services](/azure/iot-fundamentals/) can be used to automatically bring new locations and devices online and keep them up to date.</span></span>

### <a name="security"></a><span data-ttu-id="0d8ad-169">Güvenlik</span><span class="sxs-lookup"><span data-stu-id="0d8ad-169">Security</span></span>

<span data-ttu-id="0d8ad-170">Bu çözüm, müşteri görüntülerini yakalar ve güvenlik için bir parametre dikkate alır.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-170">This solution captures customer images, making security a paramount consideration.</span></span> <span data-ttu-id="0d8ad-171">Tüm depolama hesaplarının uygun erişim ilkeleriyle güvenli olduğundan emin olun ve anahtarları düzenli olarak döndürün.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-171">Make sure all storage accounts are secured with the proper access policies and rotate keys regularly.</span></span> <span data-ttu-id="0d8ad-172">Depolama hesaplarının ve Event Hubs kurumsal ve kamu gizlilik düzenlemelerine uyan bekletme ilkelerine sahip olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-172">Ensure storage accounts and Event Hubs have retention policies that meet corporate and government privacy regulations.</span></span> <span data-ttu-id="0d8ad-173">Ayrıca, Kullanıcı erişim seviyelerini katmandığınızdan emin olun.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-173">Also make sure to tier the user access levels.</span></span> <span data-ttu-id="0d8ad-174">Katmanlama, kullanıcıların yalnızca rolleri için ihtiyaç duydukları verilere erişmesini sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-174">Tiering ensures that users only have access to the data they need for their role.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0d8ad-175">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="0d8ad-175">Next steps</span></span>

<span data-ttu-id="0d8ad-176">Bu makalede tanıtılan konular hakkında daha fazla bilgi edinmek için:</span><span class="sxs-lookup"><span data-stu-id="0d8ad-176">To learn more about the topics introduced in this article:</span></span>

- <span data-ttu-id="0d8ad-177">Bkz. yararlanılabilir [,,,](https://aka.ms/tiereddatadeploy),</span><span class="sxs-lookup"><span data-stu-id="0d8ad-177">See the [Tiered Data pattern](https://aka.ms/tiereddatadeploy), which is leveraged by the footfall detection pattern.</span></span>
- <span data-ttu-id="0d8ad-178">Özel Vision kullanma hakkında daha fazla bilgi edinmek için bkz. [özel görüntü işleme AI geliştirme seti](https://azure.github.io/Vision-AI-DevKit-Pages/) .</span><span class="sxs-lookup"><span data-stu-id="0d8ad-178">See the [Custom Vision AI Dev Kit](https://azure.github.io/Vision-AI-DevKit-Pages/) to learn more about using custom vision.</span></span> 

<span data-ttu-id="0d8ad-179">Çözüm örneğini test etmeye hazırsanız, [Betfall algılama dağıtım kılavuzu](solution-deployment-guide-retail-footfall-detection.md)ile devam edin.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-179">When you're ready to test the solution example, continue with the [Footfall detection deployment guide](solution-deployment-guide-retail-footfall-detection.md).</span></span> <span data-ttu-id="0d8ad-180">Dağıtım Kılavuzu, bileşenlerinin dağıtılması ve test edilmesi için adım adım yönergeler sağlar.</span><span class="sxs-lookup"><span data-stu-id="0d8ad-180">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span>
